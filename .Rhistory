knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
Health_Literacy_Transformed_Data <- read_excel("Health Literacy Transformed Data.xlsx",
sheet = "Transformed")
summary(Health_Literacy_Transformed_Data)
#cause of death
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Cause of Death`,fill=Insurance),stat='count')+
facet_grid(~Race)
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Race`,fill=Insurance),stat='count')
#surgery decision
ggplot(data=Health_Literacy_Transformed_Data)+
geom_histogram(mapping=aes(x=Insurance,fill=`Surgery Decision`),stat='count')+
coord_flip()+
facet_grid(~Race)
#Radiation
ggplot(data=Health_Literacy_Transformed_Data)+
geom_histogram(mapping=aes(x=`Radiation`,fill=Insurance),stat='count')+
coord_flip()+
facet_grid(~Race)
#stage
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`AJCC 7 Stage`,fill=`Surgery Decision`),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`AJCC 7 Stage`,fill=Chemotherapy),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`AJCC 7 Stage`,fill=Radiation),stat='count')
#stage
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Race`,fill=`Surgery Decision`),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Race`,fill=Chemotherapy),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Race`,fill=Radiation),stat='count')
#stage
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`SEER Registry`,fill=`Surgery Decision`),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`SEER Registry`,fill=Chemotherapy),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`SEER Registry`,fill=Radiation),stat='count')
#stage
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Site`,fill=`Surgery Decision`),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Site`,fill=Chemotherapy),stat='count')
ggplot(data=Health_Literacy_Transformed_Data)+geom_histogram(mapping=aes(x=`Site`,fill=Radiation),stat='count')
library(psych)
library(vcd)
cor<-Health_Literacy_Transformed_Data[,2:25]
#poly_cor = polychoric(cor)
table <- xtabs(~Sex+`Age at Diagnosis`+Race+Insurance+`SEER Registry`+Site+Subsite+`AJCC 7 Stage`+Size+`Lymph Nodes`+Mets+`Cause of Death`+`Surgery Decision`+Radiation+Chemotherapy,data=cor )
sg <- filter(Health_Literacy_Transformed_Data,Site=='Salivary Gland' )
ggplot(data=sg)+geom_histogram(mapping=aes(x=`Surgery Performed?`,fill=`Surgery Decision`),stat='count')
sali <- Health_Literacy_Transformed_Data %>% filter(Site == "Salivary Gland")
sali <- sali %>% filter(`AJCC 7 Stage` != "IVC" & `AJCC 7 Stage` != "IVNOS")
sali$follow <- 0
saliB <- sali %>% filter(`AJCC 7 Stage` != "IVB")
unique(saliB$`Surgery Decision`)
for(i in 1:nrow(sali)){
if (sali[i,]$`AJCC 7 Stage` != "IVB"){
if(sali[i,]$`Surgery Decision` != "Not recommended"){
sali[i,]$follow = 1
}
} else{
if(sali[i,]$`Surgery Decision` == "Not recommended" | sali[i,]$`Surgery Decision` == "Not recommended, contraindicated due to              other cond; autopsy only (1973-2002)") {
sali[i,]$follow == 1
}
}
}
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Race`,fill=`Surgery Performed?`),stat='count')
ggplot(data=oral)+geom_histogram(mapping=aes(x=`Insurance`,fill=`Surgery Performed?`),stat='count')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Race`,fill=`Surgery Performed?`),stat='count')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Insurance`,fill=`Surgery Performed?`),stat='count')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Race`,fill=`follow`),stat='count')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Insurance`,fill=`Surgery Performed?`),stat='count')
sali$follow <- as.factor(sali$follow)
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Race`,fill=`follow`),stat='count')
ggplot(data=sali)+geom_bar(mapping=aes(x=`Race`,fill=`follow`),stat='count')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Insurance`,fill=`Surgery Performed?`),stat='count')
ggplot(data=sali)+geom_bar(mapping=aes(x=`Race`,fill=`follow`),stat='count',position = 'dodge')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Insurance`,fill=`follow`),stat='count')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Insurance`,fill=`follow`),stat='count',,position = 'dodge')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Insurance`,fill=`follow`),stat='count',position = 'dodge')
ggplot(data=sali)+geom_bar(mapping=aes(x=`Insurance`,fill=`follow`),stat='count',position = 'dodge')
ggplot(data=sali)+geom_bar(mapping=aes(x=`Race`,fill=`follow`),stat='count',position = 'dodge')
ggplot(data=sali)+geom_histogtam(mapping=aes(x=`Race`,fill=`follow`),stat='count',position = 'dodge')
ggplot(data=sali)+geom_histgram(mapping=aes(x=`Race`,fill=`follow`),stat='count',position = 'dodge')
ggplot(data=sali)+geom_histogram(mapping=aes(x=`Race`,fill=`follow`),stat='count',position = 'dodge')
